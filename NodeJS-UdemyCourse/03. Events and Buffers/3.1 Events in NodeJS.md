# 3.1 Events in NodeJS [ 23/08/2025 ]

---

## Event Driven Architecture

- Node.js Works on Event-Driven architecture
    - where objects called "emitters" emit named events that cause function objects ("Event Listeners/Handlers") to be called.
- Event-Driven Architecture → whenever an Event Occurs/Happens then only invoke the CPU
- Events in Node.js work like a publisher-subscriber model
    - where an event is emitted and event listeners (handlers) respond to it.

## what are Events in Node.js?

An **event** in Node.js is a signal that **something has happened** in the application — for example:

- A file was read
- A request was received
- A timer finished
- A stream has new data

When these events are **emitted**, then you can register **listeners/handlers** (functions) to respond when those events happen.

## why Use Events?

- Helps in asynchronous programming without callback hell.
- Used heavily in real-time applications like chat apps, notifications, and streams.
- Core modules like fs, http, and stream use events internally.

## `EventEmitter`

The `EventEmitter` class in the events module → is used to handle customs events in Node.js.

```jsx
let events = require('events');
let eventEmitter = new events.EventEmitter();

//Create an event handler:
let myEventHandler = function () {
  console.log('I hear a scream!');
}

//Assign the event handler to an event:
eventEmitter.on('scream', myEventHandler);

//Fire the 'scream' event:
eventEmitter.emit('scream');
```

```jsx
const EventEmitter = require('node:events');
const eventEmitter = new EventEmitter();
// This Creates an eventEmitter Object

eventEmitter.on('greet', (user) => {
    console.log(`Hello ${user}, Welcome to Events in NodeJS`); 
})
// This allows you to register a listener (callback function) ON a specific event.

eventEmitter.emit('greet', 'Paris');
// This Emits the Event [ Custom Event ] called 'greet'
// 1st para --> Name of the Event
// 2nd Para --> Arguments
```

- `eventEmitter.on` is a method in Node.js → Allows you to **register a listener (callback function)** ON a specific **event**.
- `emitter.emit()` → **Triggers/Emits** the event.

<aside>
💡

NOTE:

---

- `emitter.once()` → Adds a **one-time** listener (runs only once & Listens to the 1st event trigger only).
- `eventEmitter.on` → Adds a Multi**-time** listener ( Runs n times if the event is triggered n times ]
    
    ```jsx
    const EventEmitter = require('node:events');
    const eventEmitter = new EventEmitter();
    
    eventEmitter.on('scream', (user) => {
        console.log(`Heard a Scream from ${user}`);
    });
    
    eventEmitter.once('notify', (user) => {
        console.log(`Notified the User: ${user}`);
    });
    
    eventEmitter.emit('scream', "London");
    eventEmitter.emit('scream', "Paris");
    eventEmitter.emit("notify", "Hamilton");
    eventEmitter.emit("notify", "Pamela");
    eventEmitter.emit('scream', "Toretto");
    ```
    
</aside>

## How to Remove Event Listeners

- You can remove a listener with `.off()` or `.removeListener()`
    - But, To remove a Listener, we must need a Reference to Function
    - Hence, Inline Function Listeners Cannot be Removed

```jsx
// Removing Listeners
function listener (user) {
    console.log(`Hello ${user}`);
}
eventEmitter.on('hello', listener);
eventEmitter.emit('hello', 'Fandiago');
eventEmitter.emit('hello', 'fandom');

eventEmitter.removeListener('hello', listener);
eventEmitter.emit('hello', 'John');
```

```jsx
eventEmitter.on('hi', (user) => {
    console.log(`Hi ${user}`);
});
eventEmitter.emit('hi', "Dominic")

eventEmitter.removeListener('hi');       // Throws Error
eventEmitter.emit('hi', "Brainiac");
```

- As this is an Inline Function Listener → No Ref → Hence, Error

<aside>
💡

NOTE:

---

- `eventEmitter.removeAllListeners()` → **does *not*** require a function reference.
    - `eventEmitter.removeAllListeners([eventName])` removes:
        - **All listeners** for **all events** — if no `eventName` is passed.
        - **All listeners** for a **specific event** — if `eventName` is passed.
</aside>

| Method | Removes What? | Requires Function Ref? |
| --- | --- | --- |
| `removeListener(event, fn)` | Just the specific listener | ✅ Yes |
| `removeAllListeners()` | All listeners for all events | ❌ No |
| `removeAllListeners(event)` | All listeners for a specific event | ❌ No |

## Class based Event Emitter

```jsx
const EventEmitter = require('node:events');

// Creating a Chat class
class Chat extends EventEmitter {
    sendMessage (msg) {
        console.log(`Created a class function to trigger event`);
        // Adding event emitter inside a Class Function
        this.emit('message', msg);
    }
}

// Create an Instance/Object
let chat = new Chat();

// Adding Listener
chat.on('message', (data) => {
    console.log(`The Message is : ${data}`);
})

// Calling class function using chat Obj
chat.sendMessage('Event is Triggered using a class function')
```